require 'spec_helper'

describe "Wifi Beacon" do

  before(:all) do
    fixture = "\000\000\032\000/H\000\000\322`5_3\000\000\000\020\002v\t\240\000\305\001\000\000\200\000\000\000\377\377\377\377\377\377 N\177\236\031\202 N\177\236\031\202\200\300\2171u\257\341\000\000\000d\000\021\004\000\rpilita57b_EXT\001\b\202\204\v\026$0Hl\003\001\v\005\004\000\002\000\000*\001\004/\001\0040\030\001\000\000\017\254\002\002\000\000\017\254\004\000\017\254\002\001\000\000\017\254\002\f\0002\004\f\022\030`-\032\374\030\037\377\377\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000=\026\v\b\021\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\000\335\016\000P\362\004\020J\000\001\020\020D\000\001\002\335\t\000\020\030\002\003\360\004\000\000\335\034\000P\362\001\001\000\000P\362\002\002\000\000P\362\004\000P\362\002\001\000\000P\362\002\f\000\335\030\000P\362\002\001\001\200\000\003\244\000\000'\244\000\000BC^\000b2/\000\331:\226."    
    @packet = WifiPacket.new.read fixture
  end
  
  it "should have a management frame type" do
    @packet.should be_management
  end

  it "should have a beacon frame sub-type" do
    @packet.should be_beacon
  end

  it "should have a valid SSID" do
    @packet.ssid.should_not be_blank
  end

  it_behaves_like "Wifi Packet"

end